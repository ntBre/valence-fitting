import json
from curate_dataset import filter_opt_data
from openff.qcsubmit.results import OptimizationResultCollection

d = json.loads(r"""{"entries":{"https://api.qcarchive.molssi.org:443/":[{"type":"optimization","record_id":"110312689","cmiles":"[H:20][c:1]1[c:2]([c:4]([c:6]2[c:5]([c:3]1[H:22])[C:11]([C:12]([C:13]([N:16]2[C:10](=[O:18])[C:9]3=[N:15][N:17]([C:7](=[C:8]3[I:19])[H:24])[C:14]([H:31])([H:32])[H:33])([H:29])[H:30])([H:27])[H:28])([H:25])[H:26])[H:23])[H:21]","inchi_key":"ZMJJXESULWISRW-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312688","cmiles":"[H:20][c:1]1[c:2]([c:4]([c:6]2[c:5]([c:3]1[H:22])[C:11]([C:12]([C:13]([N:16]2[C:10](=[O:18])[C:9]3=[N:15][N:17]([C:7](=[C:8]3[I:19])[H:24])[C:14]([H:31])([H:32])[H:33])([H:29])[H:30])([H:27])[H:28])([H:25])[H:26])[H:23])[H:21]","inchi_key":"ZMJJXESULWISRW-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312685","cmiles":"[H:20][c:1]1[c:2]([c:4]([c:6]2[c:5]([c:3]1[H:22])[C:11]([C:12]([C:13]([N:16]2[C:10](=[O:18])[C:9]3=[N:15][N:17]([C:7](=[C:8]3[I:19])[H:24])[C:14]([H:31])([H:32])[H:33])([H:29])[H:30])([H:27])[H:28])([H:25])[H:26])[H:23])[H:21]","inchi_key":"ZMJJXESULWISRW-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312690","cmiles":"[H:20][c:1]1[c:2]([c:4]([c:6]2[c:5]([c:3]1[H:22])[C:11]([C:12]([C:13]([N:16]2[C:10](=[O:18])[C:9]3=[N:15][N:17]([C:7](=[C:8]3[I:19])[H:24])[C:14]([H:31])([H:32])[H:33])([H:29])[H:30])([H:27])[H:28])([H:25])[H:26])[H:23])[H:21]","inchi_key":"ZMJJXESULWISRW-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312691","cmiles":"[H:13][c:2]1[c:4]([c:7]([c:5]([c:3]([c:6]1[C:8](=[O:11])[C:9]([H:17])([H:18])[C:1]#[N:10])[H:14])[H:16])[I:12])[H:15]","inchi_key":"QPMWEBPDZJGVNS-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312693","cmiles":"[H:13][c:2]1[c:4]([c:7]([c:5]([c:3]([c:6]1[C:8](=[O:11])[C:9]([H:17])([H:18])[C:1]#[N:10])[H:14])[H:16])[I:12])[H:15]","inchi_key":"QPMWEBPDZJGVNS-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312692","cmiles":"[H:13][c:2]1[c:4]([c:7]([c:5]([c:3]([c:6]1[C:8](=[O:11])[C:9]([H:17])([H:18])[C:1]#[N:10])[H:14])[H:16])[I:12])[H:15]","inchi_key":"QPMWEBPDZJGVNS-UHFFFAOYNA-N"},{"type":"optimization","record_id":"110312694","cmiles":"[H:13][c:1]1[c:3]([c:4]([c:6]([c:2]([c:5]1[I:11])[H:14])[I:12])[N:8]([H:15])[H:16])[C:7](=[O:10])[N:9]([H:17])[H:18]","inchi_key":"WDDCFATZFHRUQL-QMLCPYSLNA-N"},{"type":"optimization","record_id":"110312696","cmiles":"[H:19][c:1]1[c:2]([c:4]([c:6]([c:5]([c:3]1[H:21])[C:8](=[O:17])[N:16]([H:35])[N:15]=[C:7]2[C:9]([C:11]([C:13]([C:12]([C:10]2([H:25])[H:26])([H:29])[H:30])([H:31])[C:14]([H:32])([H:33])[H:34])([H:27])[H:28])([H:23])[H:24])[I:18])[H:22])[H:20]","inchi_key":"BOQYMFVUTFZOLP-ADCFUYHLNA-N"},{"type":"optimization","record_id":"110312700","cmiles":"[H:19][c:1]1[c:2]([c:4]([c:6]([c:5]([c:3]1[H:21])[C:8](=[O:17])[N:16]([H:35])[N:15]=[C:7]2[C:9]([C:11]([C:13]([C:12]([C:10]2([H:25])[H:26])([H:29])[H:30])([H:31])[C:14]([H:32])([H:33])[H:34])([H:27])[H:28])([H:23])[H:24])[I:18])[H:22])[H:20]","inchi_key":"BOQYMFVUTFZOLP-ADCFUYHLNA-N"},{"type":"optimization","record_id":"110312697","cmiles":"[H:19][c:1]1[c:2]([c:4]([c:6]([c:5]([c:3]1[H:21])[C:8](=[O:17])[N:16]([H:35])[N:15]=[C:7]2[C:9]([C:11]([C:13]([C:12]([C:10]2([H:25])[H:26])([H:29])[H:30])([H:31])[C:14]([H:32])([H:33])[H:34])([H:27])[H:28])([H:23])[H:24])[I:18])[H:22])[H:20]","inchi_key":"BOQYMFVUTFZOLP-ADCFUYHLNA-N"},{"type":"optimization","record_id":"110312701","cmiles":"[H:11][c:1]1[c:2]([c:4]([c:6]([c:5]([c:3]1[H:13])[F:9])[I:10])[O:8][C:7]([H:14])([H:15])[H:16])[H:12]","inchi_key":"CPTMVKLYWHEOMG-UHFFFAOYNA-N"}]},"provenance":{"applied-filters":{"ElementFilter-0":{"allowed_elements":["H","C","N","O","S","P","F","Cl","Br"]},"RecordStatusFilter-1":{"status":"COMPLETE"},"ConnectivityFilter-2":{"tolerance":1.2},"UnperceivableStereoFilter-3":{"toolkits":["openeye","rdkit"]},"ConformerRMSDFilter-4":{}}},"type":"OptimizationResultCollection"}""")
dataset = OptimizationResultCollection(entries=d['entries'])
#dataset = OptimizationResultCollection.parse_file("/home/brent/omsf/clone/sage-2.1.0/inputs-and-outputs/data-sets/opt-set-for-fitting-2.1.0.json")
#key = list(dataset.entries.keys())[0]
#dataset.entries[key] = dataset.entries[key][:25]
dataset = filter_opt_data(
    dataset,
    "../opt_records_to_remove.dat",
    include_iodine=False,
)
print(dataset.json())

